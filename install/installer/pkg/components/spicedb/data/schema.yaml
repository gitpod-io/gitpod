# Copyright (c) 2023 Gitpod GmbH. All rights reserved.
# Licensed under the GNU Affero General Public License (AGPL).
# See License.AGPL.txt in the project root for license information.

schema: |-
  definition user {}

  definition team {
  	relation org: organisation
  	relation member: user
  	relation owner: user
  	permission read_teams = owner + member + org->read_teams
  	permission invite_members = owner
  }

  definition project {}

  definition organisation {
  	relation owner: user
  	relation member: user
  	relation service: service
  	permission read_teams = owner + service
  	permission write_teams = owner + service
  	permission read_workspaces = owner + service
  }

  definition workspace {
  	relation org: organisation
  	relation owner: user
  	permission create_workspace = org->member
  	permission delete_workspace = owner + org->owner
  }

  definition service {}

# relationships to be used for assertions
relationships: >-
  organisation:org1#owner@user:user1

assertions:
  assertTrue:
    - "organisation:org1#owner@user:user1"
    - "organisation:org1#read_teams@user:user1"
    - "organisation:org1#write_teams@user:user1"
    - "organisation:org1#read_workspaces@user:user1"

  assertFalse:
    - "organisation:org2#owner@user:user1"
