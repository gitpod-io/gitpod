# Copyright (c) 2022 Gitpod GmbH. All rights reserved.
# Licensed under the GNU Affero General Public License (AGPL).
# See License.AGPL.txt in the project root for license information.

packages:
  - name: app
    type: go
    argdeps:
      - SEGMENT_IO_TOKEN
    srcs:
      - "main.go"
      - "go.sum"
      - "go.mod"
    env:
      - CGO_ENABLED=0
    config:
      packaging: app
      buildCommand:
        [
          "go",
          "build",
          "-trimpath",
          "-ldflags",
          "-buildid= -w -s -X 'main.segmentIOToken=${SEGMENT_IO_TOKEN}'",
        ]
